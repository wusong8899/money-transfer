{"version":3,"file":"forum.js","sources":["../src/forum/model/TransferMoney.js","../src/forum/components/sources/UserSearchSource.jsx","../src/forum/components/TransferMoneySearchModal.jsx","../src/forum/components/TransferMoneySuccessModal.jsx","../src/forum/components/TransferMoneyModal.jsx","../src/forum/components/TransferMoneyNotification.js","../src/forum/components/TransferHistoryListItem.jsx","../src/forum/components/TransferHistoryList.jsx","../src/forum/components/TransferHistoryPage.jsx","../src/forum/addTransferMoneyPage.js","../src/forum/addClient1CustomizationFeatures.ts","../src/forum/index.ts"],"sourcesContent":["import Model from \"flarum/Model\";\n\nexport default class TransferMoney extends Model {}\nObject.assign(TransferMoney.prototype, {\n  id: Model.attribute(\"id\"),\n  transferMoney: Model.attribute(\"transfer_money_value\"),\n  notes: Model.attribute(\"notes\"),\n  assignedAt: Model.attribute(\"assigned_at\"),\n  fromUser: Model.hasOne(\"fromUser\"),\n  targetUser: Model.hasOne(\"targetUser\"),\n});\n","import app from 'flarum/forum/app';\nimport highlight from 'flarum/common/helpers/highlight';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\n\nexport default class UserSearchSource {\n  view(query) {\n    if(query.length<3 || this.loading){\n      return;\n    } \n\n    if(!app.cache.userSearchResults){\n      app.cache.userSearchResults = [];\n    }\n\n    this.query = query;\n    const currentUserID = app.session.user.id();\n\n    if (!app.cache.userSearchResults[this.query]) {\n      this.loading = true;\n\n      app.cache.userSearchResults[this.query] = [];\n      app.store\n        .find('users', {\n          filter: { q: this.query + ' allows-pd' },\n          page: { limit: 5 },\n        })\n        .then(this.pushResults.bind(this));\n    } else\n      return [\n        <li className=\"Dropdown-header\">{app.translator.trans('wusong8899-transfer-money.forum.search_user_header')}</li>,\n        app.cache.userSearchResults[this.query].map((user) => {\n          if(currentUserID!=user.id()){\n            const name = username(user);\n            const children = [highlight(name.text, this.query)];\n\n            return (\n              <li className=\"SearchResult\" data-index={'users:' + user.id()}>\n                <a data-index={'users:' + user.id()}>\n                  {avatar(user)}\n                  {{ ...name, text: undefined, children }}\n                </a>\n              </li>\n            );\n          }\n        }),\n      ];\n  }\n\n  pushResults(results) {\n    results.payload.data.map((result) => {\n      var user = app.store.getById('users', result.id);\n      app.cache.userSearchResults[this.query].push(user);\n    });\n    this.loading = false;\n    m.redraw();\n  }\n}\n","import app from 'flarum/forum/app';\nimport Search from 'flarum/forum/components/Search';\nimport UserSearchSource from './sources/UserSearchSource';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport username from 'flarum/common/helpers/username';\nimport avatar from 'flarum/common/helpers/avatar';\n\nexport default class TransferMoneySearchModal extends Search {\n\n  inputUuid;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.inputUuid = Math.random().toString(36).substring(2);\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    const $search = this;\n\n    this.$('.Search-results').on('click', () => {\n      const target = this.$('.SearchResult.active');\n\n      $search.addRecipient(target.data('index'));\n      $search.$('.RecipientsInput').focus();\n    });\n\n    this.$('.Search-results').on('touchstart', (e) => {\n      const target = this.$(e.target.parentNode);\n\n      $search.addRecipient(target.data('index'));\n      $search.$('.RecipientsInput').focus();\n    });\n\n    $('.RecipientsInput')\n      .on('input', () => {\n        clearTimeout(this.typingTimer);\n        this.doSearch = false;\n        this.typingTimer = setTimeout(() => {\n          this.doSearch = true;\n          m.redraw();\n        }, 900);\n      })\n      .on('keydown', () => {\n        clearTimeout(this.typingTimer);\n      });\n\n    super.oncreate(vnode);\n  }\n\n  view() {\n    if (typeof this.searchState.getValue() === 'undefined') {\n      this.searchState.setValue('');\n    }\n\n    const loading = this.searchState.getValue() && this.searchState.getValue().length >= 3;\n\n    if (!this.sources) {\n      this.sources = this.sourceItems().toArray();\n    }\n\n    const selectedUserArray = this.attrs.selected().toArray();\n\n    return (\n      <div role=\"search\" className=\"Search\">\n        <div className=\"RecipientsInput-selected RecipientsLabel\" aria-live=\"polite\">\n          <div style=\"padding-bottom:10px;font-weight:bold;font-size: 14px;color: var(--text-color);\">{app.translator.trans('wusong8899-transfer-money.forum.transfer-money-to-user')}</div>\n\n          {selectedUserArray.length===0 && (\n            <div style=\"height:34px;cursor: default !important;\" class=\"transferSearchUserContainer\">{app.translator.trans('wusong8899-transfer-money.forum.transfer-money-no-user-selected')}</div>\n          )}\n\n          {this.attrs\n            .selected()\n            .toArray()\n            .map((recipient) => {\n              const userName = username(recipient);\n              const userAvatar = avatar(recipient);\n              const userID = recipient.data.id;\n              this.attrs.selectedUsers[userID] = 1;\n\n              return (\n                <div class=\"transferSearchUserContainer\" onclick={(e) => this.removeRecipient(recipient, e)}><span class='transferSearchUser'>{userAvatar}</span> {userName}</div>\n              );\n            })}\n        </div>\n\n        <div className=\"Form-group\">\n          <label for={`transfer-money-user-search-input-${this.inputUuid}`}>{app.translator.trans('wusong8899-transfer-money.forum.transfer-money-search-user')}</label>\n\n          <div className=\"AddRecipientModal-form-input Search-input\">\n            <input\n              id={`transfer-money-user-search-input-${this.inputUuid}`}\n              className={classList('RecipientsInput', 'FormControl', {\n                open: !!this.searchState.getValue(),\n                focused: !!this.searchState.getValue(),\n                active: !!this.searchState.getValue(),\n                loading: !!this.loadingSources,\n              })}\n              type=\"search\"\n              placeholder={extractText(app.translator.trans('wusong8899-transfer-money.forum.transfer-money-search-user-placeholder'))}\n              value={this.searchState.getValue()}\n              oninput={(e) => this.searchState.setValue(e.target.value)}\n              onfocus={() => (this.hasFocus = true)}\n              onblur={() => (this.hasFocus = false)}\n            />\n            <ul\n              className={classList('Dropdown-menu', 'Search-results', 'fade', {\n                in: !!loading,\n              })}\n            >\n              {!this.doSearch\n                ? LoadingIndicator.component({ size: 'tiny', className: 'Button Button--icon Button--link' })\n                : this.sources.map((source) => source.view(this.searchState.getValue()))}\n            </ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  sourceItems() {\n    const items = new ItemList();\n    items.add('users', new UserSearchSource());\n    return items;\n  }\n\n  addRecipient(value) {\n    let values = value.split(':');\n    let type = values[0];\n    let id = values[1];\n    let recipient = this.findRecipient(type, id);\n    const userID = recipient.data.id;\n\n    this.attrs.selected().add(value, recipient);\n    this.attrs.selectedUsers[userID] = 1;\n    this.searchState.clear();\n    this.attrs.needMoney(this.getNeedMoney());\n    this.attrs.callback();\n  }\n\n  removeRecipient(recipient, e) {\n    e.preventDefault();\n\n    const userID = recipient.data.id;\n    delete this.attrs.selectedUsers[userID];\n\n    let type = \"users\";\n    this.attrs.selected().remove(type + ':' + recipient.id());\n    this.attrs.needMoney(this.getNeedMoney());\n    this.attrs.callback();\n  }\n\n  getNeedMoney(){\n    const moneyTransferValue = $(\"#moneyTransferInput\").val();\n    return moneyTransferValue*Object.keys(this.attrs.selectedUsers).length;\n  }\n\n  findRecipient(store, id) {\n    return app.store.getById(store, id);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\n\nexport default class TransferMoneySuccessModal extends Modal {\n  static isDismissible = false;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n  }\n\n  className() {\n    return 'Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('wusong8899-transfer-money.forum.transfer-money-success');\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div style=\"text-align:center\">\n            {Button.component({\n                style:'width:66px',\n                className: 'Button Button--primary',\n                onclick: () => {\n                  location.reload();\n                }\n              },\n              app.translator.trans('wusong8899-transfer-money.forum.ok')\n            )}\n          </div>\n      </div>,\n    ];\n  }\n}","import app from 'flarum/forum/app';\nimport Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport SearchState from 'flarum/forum/states/SearchState';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport Alert from 'flarum/common/components/Alert';\n\nimport TransferMoneySearchModal from './TransferMoneySearchModal';\nimport TransferMoneySuccessModal from './TransferMoneySuccessModal';\n\nexport default class TransferMoneyModal extends Modal {\n  static isDismissible = false;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.selected = Stream(new ItemList());\n    this.selectedUsers = {};\n    this.moneyName = app.forum.attribute('antoinefr-money.moneyname') || '[money]';\n\n    const targetUser = this.attrs.user;\n    if(targetUser){\n      this.selected().add('users:' + targetUser.id(), targetUser);\n      this.selectedUsers[targetUser.id()];\n    }\n    \n    this.recipientSearch = new SearchState();\n    this.needMoney = Stream(0);\n  }\n\n  className() {\n    return 'Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('wusong8899-transfer-money.forum.transfer-money');\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">\n          <div style=\"padding-bottom:20px;\" className=\"TransferMoneyModal-form\">\n            {TransferMoneySearchModal.component({\n              state: this.recipientSearch,\n              selected: this.selected,\n              selectedUsers: this.selectedUsers,\n              needMoney: this.needMoney,\n              callback: function(){\n                m.redraw();\n              }\n            })}\n          </div>\n\n          <div className=\"Form-group\">\n            <label>{app.translator.trans('wusong8899-transfer-money.forum.current-money-amount')}{this.moneyName.replace('[money]', app.session.user.attribute(\"money\"))}</label>\n            <input id=\"moneyTransferInput\" placeholder={app.translator.trans('wusong8899-transfer-money.forum.transfer-money-input-placeholder')} required className=\"FormControl\" type=\"number\" step=\"any\" min=\"0\" oninput={() => this.moneyTransferChanged()} />\n            <div style=\"padding-top:10px\">{app.translator.trans('wusong8899-transfer-money.forum.need-money-amount')}<span id=\"needMoneyContainer\">{this.moneyName.replace('[money]', this.needMoney())}</span></div>\n          </div>\n\n          <div className=\"Form-group\">\n            <label>{app.translator.trans('wusong8899-transfer-money.forum.transfer-money-notes')}</label>\n            <textarea id=\"moneyTransferNotesInput\" maxlength=\"255\" className=\"FormControl\" />\n          </div>\n\n          <div className=\"Form-group\" style=\"text-align: center;\">\n            {Button.component(\n              {\n                className: 'Button Button--primary',\n                type: 'submit',\n                loading: this.loading,\n              },\n              app.translator.trans('wusong8899-transfer-money.forum.ok')\n            )}&nbsp;\n            {Button.component(\n              {\n                className: 'Button transferMoneyButton--gray',\n                loading: this.loading,\n                onclick: () => {\n                  this.hide();\n\n                  if(typeof(this.attrs.callback)===\"function\"){\n                    this.attrs.callback();\n                  }\n                }\n              },\n              app.translator.trans('wusong8899-transfer-money.forum.cancel')\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getTotalNeedMoney(){\n    let moneyTransferValue = parseFloat($(\"#moneyTransferInput\").val());\n\n    if(isNaN(moneyTransferValue)){\n      moneyTransferValue = 0;\n    }\n\n    return Object.keys(this.selectedUsers).length*moneyTransferValue;\n  }\n\n  moneyTransferChanged(){\n    const totalNeedMoney = this.getTotalNeedMoney();\n    const totalNeedMoneyText = this.moneyName.replace('[money]', totalNeedMoney);\n    $(\"#needMoneyContainer\").text(totalNeedMoneyText);\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    const userMoney = app.session.user.attribute(\"money\");\n    const moneyTransferValue = parseFloat($(\"#moneyTransferInput\").val());\n    const moneyTransferValueTotal = this.getTotalNeedMoney();\n    const moneyTransferNotesValue = $(\"#moneyTransferNotesInput\").val();\n\n    if(moneyTransferValueTotal>userMoney){\n      app.alerts.show(Alert, {type: 'error'}, app.translator.trans('wusong8899-transfer-money.forum.transfer-error-insufficient-fund'));\n      return;\n    }\n\n    if(Object.keys(this.selectedUsers).length===0){\n      app.alerts.show(Alert, {type: 'error'}, app.translator.trans('wusong8899-transfer-money.forum.transfer-error-no-target-user-selected'));\n      return;\n    }\n\n    if(moneyTransferValue>0){\n      const moneyTransferData = {\n        moneyTransfer:moneyTransferValue,\n        moneyTransferNotes:moneyTransferNotesValue,\n        selectedUsers:JSON.stringify(Object.keys(this.selectedUsers))\n      };\n\n      this.loading = true;\n\n      app.store\n        .createRecord(\"transferMoney\")\n        .save(moneyTransferData)\n        .then(\n          (payload) => {\n            app.store.pushPayload(payload);\n            app.modal.show(TransferMoneySuccessModal);\n            this.loading = false;\n            \n            if(typeof(this.attrs.callback)===\"function\"){\n              this.attrs.callback();\n            }\n          }\n        )\n        .catch(() => {\n          this.loading = false;\n        });\n    }\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from \"flarum/components/Notification\";\n\nexport default class TransferMoneyNotification extends Notification {\n  icon() {\n    return \"fas fa-money-bill\";\n  }\n\n  href() {\n    return app.route(\"user.transferHistory\", {\n      username: app.session.user.username(),\n    });\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('wusong8899-transfer-money.forum.notifications.user-transfer-money-to-you', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    const notification = this.attrs.notification.subject();\n    const transferMoney = notification.attribute(\"transfer_money_value\");\n    const transferID = notification.attribute(\"id\");\n    const moneyName = app.forum.attribute('antoinefr-money.moneyname') || '[money]';\n    const costText = moneyName.replace('[money]', transferMoney);\n\n    return app.translator.trans('wusong8899-transfer-money.forum.notifications.user-transfer-money-details', {\n      cost: costText,\n      id:transferID\n    });\n  }\n}\n","import Component from \"flarum/Component\";\nimport Link from \"flarum/components/Link\";\nimport avatar from \"flarum/helpers/avatar\";\nimport username from \"flarum/helpers/username\";\n\nexport default class TransferHistoryListItem extends Component {\n  view() {\n    const {transferHistory} = this.attrs;\n    const currentUserID = app.session.user.id();\n    const fromUserID = transferHistory.attribute(\"from_user_id\");\n    const assignedAt = transferHistory.assignedAt();\n    const fromUser = transferHistory.fromUser();\n    const targetUser = transferHistory.targetUser();\n    const transferMoney = transferHistory.transferMoney();\n    const transferNotes = transferHistory.notes();\n    const transferNotesText = transferNotes?transferNotes:app.translator.trans('wusong8899-transfer-money.forum.transfer-list-transfer-notes-none');\n    const transferID = transferHistory.id();\n    const transferType = app.translator.trans(currentUserID==fromUserID?\"wusong8899-transfer-money.forum.transfer-money-out\":\"wusong8899-transfer-money.forum.transfer-money-in\");\n    const transferTypeStyle = currentUserID==fromUserID?\"color:red\":\"color:green\";\n\n    const moneyName = app.forum.attribute('antoinefr-money.moneyname') || '[money]';\n    const transferMoneyText = moneyName.replace('[money]', transferMoney);\n\n    return (\n      <div className=\"transferHistoryContainer\">\n        <div style=\"padding-top: 5px;\">\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-type')}: </b>\n          <span style={transferTypeStyle}>{transferType}</span>&nbsp;|&nbsp;\n\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-assign-at')}: </b>\n          {assignedAt}\n        </div>\n\n        <div style=\"padding-top: 5px;\">\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-id')}: </b>\n          {transferID}&nbsp;|&nbsp;\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-from-user')}: </b>\n          <Link href={fromUser ? app.route.user(fromUser) : \"#\"} className=\"transferHistoryUser\" style=\"color:var(--heading-color)\">\n            {avatar(fromUser)} {username(fromUser)}\n          </Link>&nbsp;|&nbsp;\n\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-target-user')}: </b>\n          <Link href={targetUser ? app.route.user(targetUser) : \"#\"} className=\"transferHistoryUser\" style=\"color:var(--heading-color)\">\n            {avatar(targetUser)} {username(targetUser)}\n          </Link>&nbsp;|&nbsp;\n          <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-transfer-amount')}: </b>\n          {transferMoneyText}&nbsp;\n\n          {transferNotes && \n            <span>|&nbsp;\n              <b>{app.translator.trans('wusong8899-transfer-money.forum.transfer-list-transfer-notes')}: </b>\n              {transferNotesText}\n            </span>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n","import Component from \"flarum/Component\";\nimport app from \"flarum/app\";\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\nimport Button from \"flarum/components/Button\";\n\nimport TransferHistoryListItem from \"./TransferHistoryListItem\";\n\nexport default class TransferHistoryList extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = true;\n    this.moreResults = false;\n    this.transferHistory = [];\n    this.user = this.attrs.params.user;\n    this.loadResults();\n  }\n\n  view() {\n    if (this.loading) {\n      loading = LoadingIndicator.component({ size: \"large\" });\n    }\n\n    return (\n      <div>\n        <div style=\"padding-bottom:10px; font-size: 24px;font-weight: bold;\">\n          {app.translator.trans(\"wusong8899-transfer-money.forum.transfer-money-history\")}\n        </div>\n        <ul style=\"margin: 0;padding: 0;list-style-type: none;position: relative;\">\n          {this.transferHistory.map((transferHistory) => {\n            return (\n              <li style=\"padding-top:5px\" key={transferHistory.id()} data-id={transferHistory.id()}>\n                {TransferHistoryListItem.component({ transferHistory })}\n              </li>\n            );\n          })}\n        </ul>\n          \n        {!this.loading && this.transferHistory.length===0 && (\n          <div>\n            <div style=\"font-size:1.4em;color: var(--muted-more-color);text-align: center;height: 300px;line-height: 100px;\">{app.translator.trans(\"wusong8899-transfer-money.forum.transfer-list-empty\")}</div>\n          </div>\n        )}\n\n        {this.hasMoreResults() && (\n          <div style=\"text-align:center;padding:20px\">\n            <Button className={'Button Button--primary'} disabled={this.loading} loading={this.loading} onclick={() => this.loadMore()}>\n              {app.translator.trans('wusong8899-transfer-money.forum.transfer-list-load-more')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  loadMore() {\n    this.loading = true;\n    this.loadResults(this.transferHistory.length);\n  }\n\n  parseResults(results) {\n    this.moreResults = !!results.payload.links && !!results.payload.links.next;\n    [].push.apply(this.transferHistory, results);\n    this.loading = false;\n    m.redraw();\n\n    return results;\n  }\n\n  hasMoreResults() {\n    return this.moreResults;\n  }\n\n  loadResults(offset = 0) {\n    return app.store\n      .find(\"transferHistory\", {\n        filter: {\n          user: this.user.id(),\n        },\n        page: {\n          offset,\n        },\n      })\n      .catch(() => {})\n      .then(this.parseResults.bind(this));\n  }\n}\n","import UserPage from \"flarum/components/UserPage\";\nimport TransferHistoryList from \"./TransferHistoryList\";\n\nexport default class TransferHistoryPage extends UserPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadUser(m.route.param(\"username\"));\n  }\n\n  content() {\n    return (\n      <div className=\"TransferHistoryPage\">\n        {TransferHistoryList.component({\n          params: {\n            user: this.user,\n          },\n        })}\n      </div>\n    );\n  }\n}\n","import { extend } from \"flarum/extend\";\nimport UserPage from \"flarum/components/UserPage\";\nimport LinkButton from \"flarum/components/LinkButton\";\nimport TransferHistoryPage from \"./components/TransferHistoryPage\";\n\nexport default function () {\n  app.routes[\"user.transferHistory\"] = {\n    path: \"/u/:username/transferHistory\",\n    component: TransferHistoryPage,\n  };\n\n  extend(UserPage.prototype, \"navItems\", function (items) {\n      if(app.session.user){\n        const currentUserID = app.session.user.id();\n        const targetUserID = this.user.id();\n\n        if(currentUserID==targetUserID){\n          items.add(\n            \"transferMoney\",\n            LinkButton.component({\n                href: app.route(\"user.transferHistory\", {\n                  username: this.user.username(),\n                }),\n                icon: \"fas fa-money-bill\",\n              },\n              [\n                app.translator.trans(\n                  \"wusong8899-transfer-money.forum.transfer-money-history\"\n                )\n              ]\n            ),\n            10\n          );\n        }\n      }\n  });\n}\n","import { extend } from \"flarum/extend\";\nimport SessionDropdown from 'flarum/forum/components/SessionDropdown';\nimport TransferMoneyModal from './components/TransferMoneyModal';\n\nconst checkTime = 10;\n\nfunction detachTransferMoneyMenu() {\n  const moneyTransferClient1Customization = app.forum.attribute('moneyTransferClient1Customization');\n\n  if (moneyTransferClient1Customization !== '1') {\n    return;\n  }\n\n  let transferMoneyLabelContainer = document.getElementById(\"transferMoneyLabelContainer\");\n\n  if (transferMoneyLabelContainer !== null) {\n    $(transferMoneyLabelContainer).remove();\n    // $(\"#app-navigation\").css(\"height\",\"var(--header-height-phone)\");\n    // $(\"#content .container .IndexPage-results\").css(\"marginTop\",\"15px\");\n  }\n}\n\nfunction attachTransferMoneyMenu(vdom: Vnode<any>, _user: User): void {\n  const isMobileView = $(\"#drawer\").css('visibility') === \"hidden\";\n  const moneyTransferClient1Customization = app.forum.attribute('moneyTransferClient1Customization');\n\n  if (isMobileView === false) { return; }\n  if (moneyTransferClient1Customization !== '1') { return; }\n\n  $(\"#content .IndexPage-nav .item-nav\").css(\"display\", \"none\");\n  $(\"#content .IndexPage-nav .item-newDiscussion\").remove();\n\n  let task = setInterval(function () {\n    if (vdom.dom) {\n      clearInterval(task);\n\n      if (vdom.dom !== undefined) {\n        $(\"#content .IndexPage-nav .item-nav\").css(\"display\", \"none\");\n        $(\"#content .IndexPage-nav .item-newDiscussion\").remove();\n\n        let transferMoneyLabelContainer = document.getElementById(\"transferMoneyLabelContainer\");\n\n        if (transferMoneyLabelContainer !== null) {\n          return;\n        }\n\n        $(\"#content .IndexPage-nav .item-nav .ButtonGroup\").removeClass(\"App-titleControl\");\n        $(\"#content .IndexPage-nav .item-nav .ButtonGroup button\").addClass(\"Button--link\");\n        let itemNav = $(\"#content .IndexPage-nav .item-nav\").clone();\n\n        if (itemNav.length > 0) {\n          $(\"#itemNavClone\").remove();\n          $(itemNav).attr('id', \"itemNavClone\");\n          $(itemNav).css('display', \"\");\n          $(\"#header-secondary .Header-controls\").prepend(itemNav);\n        }\n\n        const appNavigation = document.getElementById(\"app-navigation\");\n        const moneyName = app.forum.attribute('antoinefr-money.moneyname') || '[money]';\n        const userMoneyText = moneyName.replace('[money]', app.session.user.attribute(\"money\"));\n\n        transferMoneyLabelContainer = document.createElement(\"div\");\n        transferMoneyLabelContainer.id = \"transferMoneyLabelContainer\";\n        transferMoneyLabelContainer.className = \"clientCustomizeWithdrawalButtonContainer\";\n\n        const transferMoneyContainer = document.createElement(\"div\");\n        transferMoneyContainer.className = \"clientCustomizeWithdrawalHeaderItems clientCustomizeWithdrawalHeaderTotalMoney\";\n\n        const transferMoneyText = document.createElement(\"div\");\n        transferMoneyText.innerHTML = '<span style=\"font-size:16px;\"><i class=\"fab fa-bitcoin\" style=\"padding-right: 8px;color: gold;\"></i></span>' + userMoneyText;\n        transferMoneyText.className = \"clientCustomizeWithdrawalHeaderText\"\n\n        const transferMoneyIcon = document.createElement(\"div\");\n        transferMoneyIcon.innerHTML = '<i class=\"fas fa-wallet\"></i>';\n        transferMoneyIcon.className = \"clientCustomizeWithdrawalHeaderIcon\";\n\n        transferMoneyContainer.appendChild(transferMoneyText);\n        transferMoneyContainer.appendChild(transferMoneyIcon);\n\n        const transferMoneyButtonText = document.createElement(\"div\");\n        transferMoneyButtonText.innerHTML = app.translator.trans('wusong8899-transfer-money.forum.withdrawal');\n        transferMoneyButtonText.className = \"clientCustomizeWithdrawalHeaderItems clientCustomizeWithdrawalHeaderWithdrawal\";\n\n        $(transferMoneyButtonText).click(function () {\n          app.modal.show(TransferMoneyModal);\n        });\n\n        const userAvatarContainer = document.createElement(\"div\");\n        userAvatarContainer.className = \"clientCustomizeWithdrawalHeaderItems clientCustomizeWithdrawalHeaderUser\";\n\n        const avatarClone = $(\"#header-secondary .item-session .SessionDropdown\").clone();\n        $(avatarClone).attr('id', \"avatarClone\");\n        $(avatarClone).addClass(\"App-primaryControl\");\n\n        $(userAvatarContainer).html(avatarClone);\n\n        let hideNavToggle = \"\";\n        $(avatarClone).on('click', function () {\n          hideNavToggle = hideNavToggle === \"\" ? \"none\" : \"\";\n          $(\"#content .IndexPage-nav\").css(\"display\", hideNavToggle);\n        });\n\n        transferMoneyLabelContainer.appendChild(transferMoneyContainer);\n        transferMoneyLabelContainer.appendChild(transferMoneyButtonText);\n        transferMoneyLabelContainer.appendChild(userAvatarContainer);\n        appNavigation.appendChild(transferMoneyLabelContainer);\n      }\n    }\n  }, checkTime);\n}\n\nexport default function () {\n  extend(SessionDropdown.prototype, 'view', function (vnode) {\n    if (!app.session.user) {\n      return;\n    }\n\n    const routeName = app.current.get('routeName');\n\n    if (routeName) {\n      if (routeName !== \"tags\") {\n        detachTransferMoneyMenu();\n      } else {\n        attachTransferMoneyMenu(vnode, this.attrs.user);\n      }\n    }\n  });\n}\n","import { extend } from 'flarum/extend';\r\nimport UserControls from 'flarum/utils/UserControls';\r\nimport NotificationGrid from \"flarum/components/NotificationGrid\";\r\nimport SessionDropdown from 'flarum/forum/components/SessionDropdown';\r\nimport Button from 'flarum/components/Button';\r\n\r\nimport TransferMoney from \"./model/TransferMoney\";\r\nimport TransferMoneyModal from './components/TransferMoneyModal';\r\nimport TransferMoneyNotification from \"./components/TransferMoneyNotification\";\r\nimport addTransferMoneyPage from \"./addTransferMoneyPage\";\r\nimport addClient1CustomizationFeatures from \"./addClient1CustomizationFeatures\";\r\n\r\n\r\napp.initializers.add('wusong8899-money-transfer', () => {\r\n  app.store.models.transferMoney = TransferMoney;\r\n  app.notificationComponents.transferMoney = TransferMoneyNotification;\r\n\r\n  addTransferMoneyPage();\r\n  addClient1CustomizationFeatures();\r\n\r\n  extend(NotificationGrid.prototype, \"notificationTypes\", function (items) {\r\n    items.add(\"transferMoney\", {\r\n      name: \"transferMoney\",\r\n      icon: \"fas fa-dollar-sign\",\r\n      label: app.translator.trans(\r\n        \"wusong8899-transfer-money.forum.receive-transfer-from-user\"\r\n      ),\r\n    });\r\n  });\r\n\r\n  extend(UserControls, 'moderationControls', (items, user) => {\r\n    const allowUseTranferMoney = app.forum.attribute('allowUseTranferMoney');\r\n\r\n    if(app.session.user && allowUseTranferMoney){\r\n      const currentUserID = app.session.user.id();\r\n      const targetUserID = user.id();\r\n      \r\n      if(currentUserID!==targetUserID){\r\n        items.add('transferMoney', Button.component({\r\n            icon: 'fas fa-money-bill',\r\n            onclick: () => app.modal.show(TransferMoneyModal, {user})\r\n          }, app.translator.trans('wusong8899-transfer-money.forum.transfer-money'))\r\n        );\r\n      }\r\n    }\r\n  });\r\n\r\n  extend(SessionDropdown.prototype, 'items', function (items) {\r\n    if (!app.session.user) {\r\n      return;\r\n    }\r\n\r\n    items.add(\r\n      'transferMoney',\r\n      Button.component(\r\n        {\r\n          icon: 'fas fa-money-bill',\r\n          onclick: () => {\r\n            app.modal.show(TransferMoneyModal)\r\n          },\r\n        },\r\n        app.translator.trans('wusong8899-transfer-money.forum.transfer-money')\r\n      ),\r\n      -1\r\n    );\r\n  });\r\n});\r\n"],"names":["TransferMoney","Model","UserSearchSource","query","app","currentUserID","user","name","username","children","highlight","avatar","results","result","TransferMoneySearchModal","Search","vnode","$search","target","e","loading","selectedUserArray","recipient","userName","userAvatar","userID","classList","extractText","source","LoadingIndicator","items","ItemList","value","values","type","id","store","TransferMoneySuccessModal","Modal","Button","TransferMoneyModal","Stream","targetUser","SearchState","moneyTransferValue","totalNeedMoney","totalNeedMoneyText","userMoney","moneyTransferValueTotal","moneyTransferNotesValue","Alert","moneyTransferData","payload","TransferMoneyNotification","Notification","notification","transferMoney","transferID","costText","TransferHistoryListItem","Component","transferHistory","fromUserID","assignedAt","fromUser","transferNotes","transferNotesText","transferType","transferTypeStyle","transferMoneyText","Link","TransferHistoryList","offset","TransferHistoryPage","UserPage","addTransferMoneyPage","extend","targetUserID","LinkButton","checkTime","detachTransferMoneyMenu","transferMoneyLabelContainer","attachTransferMoneyMenu","vdom","_user","isMobileView","moneyTransferClient1Customization","task","itemNav","appNavigation","userMoneyText","transferMoneyContainer","transferMoneyIcon","transferMoneyButtonText","userAvatarContainer","avatarClone","hideNavToggle","addClient1CustomizationFeatures","SessionDropdown","routeName","NotificationGrid","UserControls","allowUseTranferMoney"],"mappings":"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"}